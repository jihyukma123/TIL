# [백엔드 개발을 위해 꼭 알아야 할 전체 구성](https://www.youtube.com/watch?v=M8E6vYAIuzQ)

백엔드의 핵심 - `어떻게 유저(클라이언트)에게 데이터를 안정적으로 전달할 것인가?`

신기한게 내가 최근에 했던 생각이랑 통하는 부분이 있음. 백엔드의 본질이 뭘까? 백엔드를 잘 한다는게 뭘까라는 생각을 했을 때 결국 클라이언트가 원하는 정보를 원하는 시점에 안정적으로 전달하는 것이 제일 중요하고 사실 그거 말고는 다 별로 안중요하다는 생각을 했음.

# 그래서 백엔드 3요소가 뭔데? -> 웹서버/WAS/DB

## 웹서버

웹서버가 등장한 배경 -> 초창기 웹은 지금처럼 대중들이 많이 쓰는 기술이 아니었고, 연구소 같은 곳에서 자료를 공유하거나 하는 느낌.

이 때 제일 중요한 건 서로 다른 위치에 있는 사람들끼리 HTML을 안정적으로 공유하는 것. 내가 작성한 HTML을 어떻게 멀리 떨어진 사람에게 즉시 보여줄 수 있을까? 라는 문제를 해결하기 위해서 등장한 것이 웹서버.

초창기 웹서버는 그냥 index.html이 저장된 컴퓨터 정도였음(file server의 역할). 모든 사람이 동일한 웹페이지를 보는 구조였기 때문에 정적(Static) 웹이었음.

## WAS

Web application server

웹의 대중화와 함께, 요구되는 기능의 종류와 복잡도가 증가하기 시작함.

예를 들어, 웹사이트에 정적인 내용이 아니라 사용자의 입력에 따라 동적으로 내용이 변경시켜줘야 한다면?

생각해보니까 이를 위해서 뭐가 필요한지 생각을 못해봤네. 웹페이지에 뭔가 다른 화면을 보여주기 위해서 필요한건? 웹페이지에 뭔가를 보여주기 위해서 사용되는건 HTML인데, 그러면 다른 화면을 보여주고 싶으면?

초기에 화면을 렌더링 하기 위해서 사용했던 HTML과 다른 HTML이 필요함.

다른 HTML을 만들려면 뭐가 필요해? 사전에 정해진 방식에 따라 로직(코드)를 실행해서 새로운 HTML을 생성하는 메커니즘이 필요해짐.

사용자의 요청 -> 코드 실행 -> 생성된 결과물을 사용자에게 전송.

이게 WAS의 원형임.

기존 서버(웹서버) -> 파일만 전송(정적인 파일)
새로운 서버(WAS) -> 로직을 처리, 연산 등 처리하기 시작.(요청에 따라 동적인 파일(내용) 반환)

### 백엔드 프레임워크와 WAS는 다르다.

FastAPI 같은 프레임워크는 뭐임?

자동차를 만들기 위해서 사용되는 설계도/부품 같은 느낌.

핵심(자동차를 만드는 것)에 집중할 수 있게 무조건 재사용되는 것들(타이어, 핸들, 프레임 등)을 미리 구현한 것.

WAS는 개발자가 이런 백엔드 Framework를 활용해서 만든 서버 프로그램을 실행시켜주는 런타임 환경.

둘의 차이는 실제로 데이터가 WAS로 들어와서 백엔드 프레임워크에 의해서 처리되는 과정을 보면 이해에 도움이 됨.

### 요청 처리 과정

클라이언트에서 WAS로 HTTP요청을 전송함.

이 정보는 Raw HTTP 패킷 형태로 서버 컴퓨터로 전달이 됨.

WAS가 이 HTTP 패킷을 해석해서 Request객체를 생성해서 백엔드 프레임워크에 전달.

백엔드 프레임워크는 URL에 해당되는 컨트롤러를 실행해서 json/html페이지 같은 결과값을 Response 객체에 담아서 WAS에 전달

WAS는 Response 객체를 원시 HTTP 패킷 형태로 만들어서 클라이언트에 전송

-> 아니 Express만 썼지 WAS를 쓴적이 없는디 뭔소리여?

응 실제로는 Nodejs의 http 모듈을 사용하는데, Nodejs가 js를 실행하는 런타임임과 동시에 TCP 소켓을 열고 HTTP 패킷 파싱하는 WAS역할도 수행함.

## DB

좋아 이제 사용자가 좋아요를 누르면 숫자를 업데이트해서 보여줄 수 있겠어.

아니 근데 서버를 껐다 키니까 데이터가 초기화됐네..?

왜냐하면 초창기의 서버는 메모리/임시 파일에만 데이터를 들고 있었음.

그래서 서버를 끄게 되면 데이터가 다 날라가는 문제가 있었고, 이런 문제를 해결하기 위해서 백엔드 아키텍처에 가장 마지막으로 합류한 퍼즐 조각이 바로 Database

### 근데 그냥 텍스트 파일에 데이터 저장하면 안돼?

좋은 질문이라고 함.

why not이고, 이 질문에 대한 답을 아는 것. 왜 텍스트파일보다 Database에 데이터를 저장하는지를 이해하는 것이 데이터베이스의 본질을 이해하는 것이라고..

파일 시스템은 3가지 문제점이 있음.

1. 동시성 문제를 해결하지 못한다.

동시에 화담숲 예매 신청을 하는 상황을 생각해보자. 0.01초 사이에 수 많은 자리 예약 request가 전송될텐데, Database는 락을 활용해서 Race condition을 방지하고 데이터 일관성을 보장해줄 수 있음.

2. 데이터 무결성을 보장할 수 없음.

데이터베이스를 조작할 때 한 묶음으로 처리해야되는 일들이 존재함.

대표적인게 계좌이체. 내 계좌에서 돈을 빼는 처리와, 상대방의 계좌에 돈을 입금하는 처리는 반드시 한 묶음으로 처리되어야 함.

`트랜잭션`을 활용해서 데이터 무결성을 보장

3. 검색 속도가 느림

특정 데이터를 찾기 위해서는 사실상 파일의 모든 줄을 읽어야만 함.

DB는 책의 목차와 같은 인덱스를 활용해서 데이터 검색 효율을 향상시킬 수 있음.

파일 시스템으로 할 수 없는 기능을 제공하는 데이터 관리 시스템

## 백엔드는 결국

문제를 해결해온 역사가 아키텍처에 고스란히 반영되어 있음.

- 웹서버: 어떻게 정적 파일을 여러 사람에게 빠르고 안정적으로 제공할 수 있을까?
- WAS: 어떻게 요청에 따른 동적인 결과물을 실시간으로 만들 수 있을까?
- DB: 어떻게 데이터를 영구적이고 안전하게 보관하고 제공할까?

현대 백엔드 시스템의 핵심 철학인 역할과 책임의 분리가 어떻게 자연스럽게 진화해 왔는지 보여주는 것.
