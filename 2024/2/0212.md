# http 를 통한 서버 통신

회사에서 조만간 axios를 활용해서 http request를 할 필요가 있을 듯 해서 관련된 공부를 하였다.

**공부목표**

- 서버/클라이언트 구조, http 요청 등에 대해서 공부한다.

## WHY HTTP

왜 HTTP 에 대해서 알아야하는가?

HTTP는 온라인으로 소통하기 위해 가장 많이 쓰이는 프로토콜.

**프로토콜...?**

칠판에 `당번 - 홍길동` 라고 써져있는걸 보고, 반 아이들이 모두 이번 주의 당번이 누구인지 알 수 있는 이유는 무엇일까? 그것은 우리가 일정한 형태로 소통할 수 있도록 문자로 프로토콜이 정해져있기 때문이라고 할 수 있다. 그리고 누군가를 특정한 이름을 부여해서 구분한다는 규칙이 서로 통용되기 때문이기도 하다.

컴퓨터 간 소통의 근간이 되는 컨셉도 동일하다. 전달되는 정보가 텍스트가 아닐 뿐, 컴퓨터들끼리 HTTP로 소통을 하는 경우 각 컴퓨터는 어떻게 전달된 정보를 파싱해야되는지를 HTTP를 기반으로 처리한다. 즉 프로토콜은 0과 1을 의미있는 데이터로 해석할 수 있도록 해주는 구조라고도 볼 수 있다. 이런 프로토콜이 있기 때문에 서로 정보를 인터넷을 통해 주고 받을 수 있다.

### http 요청과 응답

가장 본질적으로 http 는 간단한 요청-응답 구조의 시스템이다.

`요청`을 수행하는 컴퓨터는 `클라이언트`라고 칭하기도 하고,
`응답`을 수행하는 컴퓨터는 `서버`라고 칭한다.

클라이언트는 요청을 보내는 컴퓨터, 그리고 그에 대한 응답을 하는 컴퓨터를 서버라고 볼 수 있다.

클라이언트에서 특정 웹페이지에 대한 요청을 하면, 해당 서버는 해당 웹페이지에 대한 정보를 응답으로 전송한다.

요청을 할 때, 웹페이지 앞에 붙는 `https://` prefix가 바로 컴퓨터에게 어떤 프로토콜로 소통할지 알려주는 부분이다.

URL은 HTTP에서만 사용되는 것이 아니라 다른 프로토콜을 통해서도 사용될 수 있는 자원이다.

### 클라이언트와 서버

일반적으로, 클라이언트는 어플리케이션의 프론트엔드의 영역이고 서버는 백엔드의 영역이다.

클라이언트에서 요청을 받은 서버에서 필요한 정보를 얻기 위해 다른 서버로 http요청을 보내는 경우도 있다. 이 상황에서는 클라이언트 요청을 받은 서버가 클라이언트이자 서버인 경우이다.

### 참고자료

- [코딩애플 유튜브(서버)](https://www.youtube.com/watch?v=NoLV5iP5FNY&list=PLfLgtT94nNq1qmsvIii_CAxFlD7tvB5NE&index=2)
- [Full HTTP Networking Course – Fetch and REST APIs in JavaScript](https://www.youtube.com/watch?v=2JYT5f2isg4)
- [HTTP 헤더(MDN)](https://developer.mozilla.org/ko/docs/Web/HTTP/Headers)

# 연습할겸 공공 API의 특일 정보 조회하기

개인 프로젝트에 휴일 정보가 필요할 듯 해서 조사해본 결과 공공데이터포탈에 한국천문연구원에서 제공하는 특일 정보 API가 있다는 것을 확인함.

이를 활용해 개인 프로젝트의 캘린더에 대한민국 휴일을 표시해보자.

아마 다음 순서로 작업을 하게 될 듯 하다.

1. 간단하게 API 검증
2. API를 활용해서 공휴일 정보 확인
3. 해당 정보를 달력에 표시

## 공공데이터 조회하기

API검증을 postman을 통해서 한 후에, 앱에서 같은 코드로 request를 시도했는데 Network Error가 발생해서 이유를 추적하였다.

어차피 나중에 서버를 구축하게 될테니 이 참에 nodejs 서버를 만들어서 http request를 시도해보려고 한다. (바로 요청을 보내는 것과 서버를 통해서 보내는 것 중 뭐가 더 나은지는 모르겠다.)

## Nodejs 로컬 서버 간단하게 만들어서 테스트

간단하게 8080 Port에 서버 띄워서, client -> server -> 공공데이터서버 순서로 요청을 보냈더니 데이터 조회에 성공함.

그리고 받은 데이터를 다시 client로 전송해주는 형태로 우선 구현하였음.

클라이언트에서는 get 요청의 query string에 원하는 month, year를 포함해서 전송하고 이를 nodejs서버에서 파싱해서 openAPI서버로 요청을 보내서 받은 응답을 client에 전송해주는 구조로 처리하였음.

### http request - GET

GET 요청이란.

- 리소스를 조회하는데 사용
- body, Content-type이 비어있고 쿼리스트링을 통해서 요청을 보낸다.
  - 쿼리스트링: url 끝에 ?과 함께 이름과 값으로 쌍을 이루는 요청 파라미터
  - 쿼리스트링을 통해 url자체에 요청 데이터가 표시되므로 보안적인 측면에서 이슈가 있음 -> 쿼리스트링에는 간단한 데이터만 포함시키는 것이 좋다.
- Idempotent 하게 설계되었다. 즉 서버의 데이터나 상태를 변경시키지 않는 것을 전제로 설계되었음

## 해당 정보를 달력에 표시

쿼리한 데이터를 가공해서 달력에서 해당되는 날짜를 빨간색으로 표시하는 처리를 하였다.

그런데 달력에서 월을 이동할 때마다 데이터를 쿼리하는 형태로 코드를 작성했더니 달력이 렌더링 되고 난 다음에 빨간색으로 색이 변경되는 이슈가 있음.

이를 구조적으로 해결할 방법에 대한 고민이 필요하다.

일단 서버에서 데이터 요청해서 화면에 뿌리는 과정은 성공한 하루.
