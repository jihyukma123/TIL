# 배포 자동화와 CI/CD에 대해서 알아보자.

React Native로 앱 기능 개발 및 버그 해결 위주로만 업무를 진행해본 사람 입장에서, 배포 자동화와 CI/CD 라는 개념에 대해서 공부해보았다.

평소에 많이 들어봤지만 큰 그림에서 어떤 부분에 해당하는 작업인지, 그리고 실제로 어떤 작업인지 이번 기회에 공부해보고 실제로 적용해보고자 한다.

## 배포 자동화? CI/CD? 다른 건가 같은 건가 하나가 다른 하나를 포함하는건가 뭘까?

배포 자동화는 CD(Continuous Delivery/Deployment)의 일부에 해당하는 작업이라고 볼 수 있다고 한다.

배포 자동화 자체는 CI/CD의 일부지만, 아주 작은 일부라고 여겨지는 것 같다.

CI/CD가 훨씬 더 큰 개념이기 때문이기 때문에 이에 대해서 먼저 공부해보자.

## CI/CD

CI/CD란 `Automates the software development process from the initial code commit(possibly from multiple developers) all the way through to deployment`

기존에 작성한 코드를 프로덕션하기 위해서 사람이 수동으로 수행했어야 하는 다음과 같은 작업들이 자동화 된 것임.

- 빌드하기
- 테스트하기
- 배포하기

이렇게 하는 가장 본질적인 목표는 `Enable software teams to deploy BETTER quality software FASTER`

아하 그렇구나.

그러면 CI/CD를 구축하는 게 실제로 배포되는 제품의 퀄리티를 높여주고 더 빠른 배포가 가능케 해주는가?

그건 상황마다 다를 수 있다.

## CI

CI는 CI/CD 중 덜 controversial 하고 더 common하게 도입되어 있는 작업이라고 한다.

CI는 간단하게 말하면 코드 변경사항을 공유하는 repository에 병합하는 것을 자동화 하는 것이다.(보다 자주, 더 빠르게 병합하는 것이 보통 바람직하다고 여겨짐)

각 commit은 CI server에 등록되어 있는 자동화된 프로세스를 trigger한다. 보통 이 과정에서 변경사항을 병합해도 괜찮을지 판단하기 위해 자동으로 테스트가 수행된다.

잘 구축된 CI프로세스는 수행되는 일련의 테스트가 좋은 테스트라는 가정하에 성립될 수 있다. 그렇기 때문에 충분한 coverage가 확보된 퀄리티 있는 테스트를 유지하는 것이 매우 중요하다.

물론 커버리지가 높아지면 테스트 시간이 오래걸려서 생산성이 저하될 수 있다는 단점도 존재한다. 그래서 필요에 따라서 커버리지와 테스트 수행 시간 사이에 밸런스를 잘 맞추는 것이 중요하다.

그러면 CI를 구현하기 위해서 필요한 도구에는 뭐가 있을까?

일단 소스코드 관리 시스템이 기본적으로 필요하겠지? 이게 바로 `Github`이다. `깃허브`에 소프트웨어를 빌드하기 위해서 필요한 모든 것이 등록되어 있어야 한다. 소스코드, 테스트 스크립트, 빌드 스크립트 등등.

CI 프로세스를 관리하기 위한 도구는 여러가지가 있다. Github Actions, Buildkite, Jenkins, CircleCI, TravisCI 등등.. 이러한 도구들은 CI에서 `빌드`와 `테스트` 프로세스를 담당한다.

`테스트`를 실제로 작성하고 실행하는 도구는 보통 언어와 해당 생태계와 연관되어 있다. 예를 들어, JavaScript 코드를 테스트하기 위해서는 Jest를 사용할 수 있다.

`빌드`를 위한 도구는 더 다양하고 언어 및 그 생태계마다 다르다. `Java - Gradle`, `JavaScript - Webpack` 처럼..

## CD

`Continuous Delivery` or `Continuous Deployment`

두 가지 모두 어떻게 배포를 자동화할지에 대한 고민이다.

CI를 통해서 코드 변경사항이 자동으로 빌드/테스트 되었다면, 배포 단계(release)를 준비하고 준비가 되었을 때 수동으로 배포하는 단계를 `Continuous Delivery`, 마지막에 준비가 다 되었을 때 배포마저 자동으로 된다면 `Continuous Deployment`

이 최종단계를 수동으로 하느냐, 자동으로 하느냐는 회사마다/상황마다 천차만별이다. 앞단 프로세스에 대해 정말 자신이 있거나, 아니면 비교적 중요하지 않은 배포 작업이거나 하다면 자동으로 할 수도 있겠지만, 반대로 마지막에 꼭 확인이 필요하다면 수동으로 하는게 더 좋은 선택일 수 있다.
